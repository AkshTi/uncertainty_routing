flatpak: error while loading shared libraries: libssl.so.10: cannot open shared object file: No such file or directory
Lmod has detected the following error: The following module(s) are unknown:
"slurm"

Please check the spelling or version number. Also try "module spider ..."
It is also possible your cache file is out-of-date; it may help to try:
  $ module --ignore_cache load "slurm"

Also make sure that all modulefiles written in TCL start with the string
#%Module



/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/transformers/utils/hub.py:110: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
`torch_dtype` is deprecated! Use `dtype` instead!
The following generation flags are not valid and may be ignored: ['temperature', 'top_p', 'top_k']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
Layers:   0%|          | 0/4 [00:00<?, ?it/s]Layers:  25%|██▌       | 1/4 [00:27<01:22, 27.42s/it]Layers:  50%|█████     | 2/4 [00:54<00:54, 27.38s/it]Layers:  75%|███████▌  | 3/4 [01:22<00:27, 27.41s/it]Layers: 100%|██████████| 4/4 [01:49<00:00, 27.43s/it]Layers: 100%|██████████| 4/4 [01:49<00:00, 27.42s/it]
/orcd/home/002/akshatat/uncertainty_routing/experiment3_4_steering_independence.py:452: FutureWarning: 

Passing `palette` without assigning `hue` is deprecated and will be removed in v0.14.0. Assign the `x` variable to `hue` and set `legend=False` for the same effect.

  sns.violinplot(data=max_eps_data, x='layer', y='delta_margin',
Questions:   0%|          | 0/10 [00:00<?, ?it/s]Questions:  10%|█         | 1/10 [00:07<01:11,  7.90s/it]Questions:  20%|██        | 2/10 [00:15<01:01,  7.72s/it]Questions:  30%|███       | 3/10 [00:23<00:53,  7.66s/it]Questions:  40%|████      | 4/10 [00:30<00:45,  7.64s/it]Questions:  50%|█████     | 5/10 [00:38<00:38,  7.64s/it]Questions:  60%|██████    | 6/10 [00:45<00:30,  7.62s/it]Questions:  70%|███████   | 7/10 [00:53<00:22,  7.60s/it]Questions:  80%|████████  | 8/10 [01:01<00:15,  7.59s/it]Questions:  90%|█████████ | 9/10 [01:08<00:07,  7.59s/it]Questions: 100%|██████████| 10/10 [01:16<00:00,  7.59s/it]Questions: 100%|██████████| 10/10 [01:16<00:00,  7.62s/it]
Steering tests:   0%|          | 0/10 [00:00<?, ?it/s]Steering tests:   0%|          | 0/10 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "/orcd/home/002/akshatat/uncertainty_routing/run_complete_pipeline.py", line 202, in <module>
    main()
  File "/orcd/home/002/akshatat/uncertainty_routing/run_complete_pipeline.py", line 156, in main
    exp4_df = exp4.run(ambiguous, best_layer)
  File "/orcd/home/002/akshatat/uncertainty_routing/experiment3_4_steering_independence.py", line 649, in run
    result = self.test_with_steering(question, context, best_layer, epsilon)
  File "/orcd/home/002/akshatat/uncertainty_routing/experiment3_4_steering_independence.py", line 602, in test_with_steering
    steered_response = self.model.generate(prompt, temperature=0.0, do_sample=False)
  File "/orcd/home/002/akshatat/uncertainty_routing/core_utils.py", line 187, in generate
    outputs = self.model.generate(
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/transformers/generation/utils.py", line 2564, in generate
    result = decoding_method(
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/transformers/generation/utils.py", line 2784, in _sample
    outputs = self(**model_inputs, return_dict=True)
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/transformers/utils/generic.py", line 918, in wrapper
    output = func(self, *args, **kwargs)
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/transformers/models/qwen2/modeling_qwen2.py", line 449, in forward
    outputs: BaseModelOutputWithPast = self.model(
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/transformers/utils/generic.py", line 1072, in wrapper
    outputs = func(self, *args, **kwargs)
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/transformers/models/qwen2/modeling_qwen2.py", line 384, in forward
    hidden_states = decoder_layer(
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/transformers/modeling_layers.py", line 94, in __call__
    return super().__call__(*args, **kwargs)
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1806, in inner
    hook_result = hook(self, args, result)
  File "/orcd/home/002/akshatat/uncertainty_routing/experiment3_4_steering_independence.py", line 594, in steering_hook_all_positions
    hidden_states[:, -1, :] += epsilon * steering_vec.to(hidden_states.device)
IndexError: too many indices for tensor of dimension 2

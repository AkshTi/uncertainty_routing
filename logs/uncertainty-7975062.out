Initializing model...
Loading model Qwen/Qwen2.5-1.5B-Instruct...
Model loaded successfully!

Loading datasets...
Test set: 40 questions
  Answerable: 10
  Unanswerable: 30

‚úì Loaded 4 explicit steering vectors

======================================================================
EXPERIMENT 5: Trustworthiness Application (FIXED VERSION)
======================================================================
Questions: 40
Layers to test: [24, 25, 26, 27]
Epsilon sweep: [-50.0, -40.0, -30.0, -20.0, -10.0, 0.0, 10.0, 20.0, 30.0, 40.0, 50.0]
  Answerable: 10, Unanswerable: 30

======================================================================
PHASE 1: Layer Selection
======================================================================

Testing 4 layers on 15 questions...
Computing baseline (Œµ=0) and steered (Œµ=20.0) for each layer...
  Layer 24: score=0.000 (Œîunans=+0.00, Œîans=+0.00)
  Layer 25: score=0.000 (Œîunans=+0.00, Œîans=+0.00)
  Layer 26: score=0.000 (Œîunans=+0.00, Œîans=+0.00)
  Layer 27: score=0.100 (Œîunans=+0.00, Œîans=-0.10)

‚úì Best layer: 27 (score=0.100)

‚ö†Ô∏è  WARNING: Unanswerables already abstaining at baseline (>90%)
   Steering has no room to improve. Need harder/tempting questions.

======================================================================
PHASE 2: Epsilon Sweep on Layer 27
======================================================================

‚úì Saved to results/exp5_raw_results.csv

======================================================================
EXPERIMENT 5: ANALYSIS
======================================================================

======================================================================
Metrics by Epsilon:
======================================================================
 epsilon  coverage_answerable  abstain_answerable  accuracy_answerable  risk_answerable  abstain_unanswerable  hallucination_unanswerable  n_answerable  n_unanswerable
   -50.0                  0.3                 0.7             1.000000         0.000000              0.900000                    0.100000            10              30
   -40.0                  0.3                 0.7             1.000000         0.000000              0.866667                    0.133333            10              30
   -30.0                  0.5                 0.5             1.000000         0.000000              0.833333                    0.166667            10              30
   -20.0                  0.6                 0.4             1.000000         0.000000              0.800000                    0.200000            10              30
   -10.0                  0.6                 0.4             1.000000         0.000000              0.700000                    0.300000            10              30
     0.0                  0.6                 0.4             1.000000         0.000000              0.633333                    0.366667            10              30
    10.0                  0.6                 0.4             1.000000         0.000000              0.533333                    0.466667            10              30
    20.0                  0.7                 0.3             0.857143         0.142857              0.500000                    0.500000            10              30
    30.0                  0.8                 0.2             0.875000         0.125000              0.400000                    0.600000            10              30
    40.0                  1.0                 0.0             0.900000         0.100000              0.300000                    0.700000            10              30
    50.0                  1.0                 0.0             0.900000         0.100000              0.300000                    0.700000            10              30

======================================================================
SIGN VERIFICATION
======================================================================
Most negative Œµ=-50.0:
  Abstain unanswerable: 90.0%
  Hallucinate unanswerable: 10.0%

Baseline Œµ=0:
  Abstain unanswerable: 63.3%
  Hallucinate unanswerable: 36.7%

Most positive Œµ=50.0:
  Abstain unanswerable: 30.0%
  Hallucinate unanswerable: 70.0%

Œî Abstention from baseline:
  Negative Œµ: +26.7%
  Positive Œµ: -33.3%

‚úì Negative epsilon increases abstention (use negative values)

======================================================================
KEY FINDINGS
======================================================================
Baseline (Œµ=0):
  Coverage (answerable):     60.0%
  Accuracy (answerable):     100.0%
  Abstain (unanswerable):    63.3%
  Hallucinate (unanswerable): 36.7%

Best steering (Œµ=-50.0):
  Coverage (answerable):     30.0% (Œî=-30.0%)
  Accuracy (answerable):     100.0% (Œî=+0.0%)
  Abstain (unanswerable):    90.0% (Œî=+26.7%)
  Hallucinate (unanswerable): 10.0% (Œî=-26.7%)

======================================================================
INTERPRETATION
======================================================================
‚ö†Ô∏è  MIXED: Steering helps unanswerables but harms answerables
  - This may still be useful for high-risk applications

üí° TIP: Try smaller |epsilon| values to reduce harm to answerables
Figure saved to results/exp5_trustworthiness.png

‚úì Summary saved to results/exp5_summary.json

‚úì Experiment 5 complete!

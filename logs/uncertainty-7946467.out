
================================================================================
 STARTING PIPELINE: STANDARD MODE
 Model: Qwen/Qwen2.5-1.5B-Instruct
 Time: 2026-01-11 22:30:37.478033
================================================================================

CUDA available: True
GPU: NVIDIA L40S
GPU Memory: 47.67 GB

[1/6] Preparing datasets...
  Ambiguous: 30
  Answerable: 10
  Unanswerable: 10

[2/6] Loading model...
Loading model Qwen/Qwen2.5-1.5B-Instruct...
Model loaded successfully!
  Loaded in 1.4s

Running Experiment 5: Trustworthiness Application...

============================================================
EXPERIMENT 5: Trustworthiness Application (FIXED)
============================================================
Testing layer 24
Questions: 10
Steering vector: shape=torch.Size([1, 1536]), norm=1.0000, device=cuda:0

============================================================
STEERING DIRECTION TEST
============================================================
Testing if -epsilon (negative steering) actually increases abstention...

Baseline response: The capital of France is Paris.
+10 steering response: The capital of France is Paris.
-10 steering response: The capital of France is Paris.

⚠️  WARNING: Negative steering did NOT produce abstention
   The steering vector may be too weak or in the wrong direction
   Continuing anyway with very high epsilon values...
============================================================

Testing with ε=0 (steering toward abstention)
  Q: What is the capital of France?
    Abstained: False, Correct: True
    Response: The capital of France is Paris....
  Q: How many days are in a week?
    Abstained: False, Correct: True
    Response: There are 7 days in a week....
  Q: What is 2 + 2?
    Abstained: False, Correct: True
    Response: 4. 

Explanation: The sum of two plus two equals four. This is a basic arithmeti...

Testing with ε=8.0 (steering toward abstention)

Testing with ε=16.0 (steering toward abstention)
  Q: What is the capital of France?
    Abstained: False, Correct: True
    Response: The capital of France is Paris....
  Q: How many days are in a week?
    Abstained: False, Correct: True
    Response: 7 days....
  Q: What is 2 + 2?
    Abstained: False, Correct: True
    Response: 4....

Testing with ε=24.0 (steering toward abstention)

Testing with ε=32.0 (steering toward abstention)

============================================================
DIAGNOSTIC - Sample Responses
============================================================

Baseline (ε=0) examples:
  Q: What is the capital of France?
     Abstained: False, Response: The capital of France is Paris.
  Q: How many days are in a week?
     Abstained: False, Response: There are 7 days in a week.
  Q: What is 2 + 2?
     Abstained: False, Response: 4. 

Explanation: The sum of two plus two equals four. This is a basic arithmeti

Max steering (ε=32.0):
  Q: What is the capital of France?
     Abstained: False, Response: The capital of France is Paris.
  Q: How many days are in a week?
     Abstained: False, Response: 7 days.
  Q: What is 2 + 2?
     Abstained: False, Response: 4.

============================================================
SUMMARY BY EPSILON
============================================================
ε=  0.0: 0/10 abstained, 10 answered (8 correct, acc=80.0%)
ε=  8.0: 0/10 abstained, 10 answered (8 correct, acc=80.0%)
ε= 16.0: 1/10 abstained, 9 answered (7 correct, acc=77.8%)
ε= 24.0: 2/10 abstained, 8 answered (7 correct, acc=87.5%)
ε= 32.0: 1/10 abstained, 9 answered (8 correct, acc=88.9%)

✓ Results saved to results/exp5_raw_results.csv

============================================================
EXPERIMENT 5: ANALYSIS
============================================================

Risk-Coverage Tradeoff:
 epsilon  coverage  accuracy     risk  n_answered  n_total
     0.0       1.0  0.800000 0.200000          10       10
     8.0       1.0  0.800000 0.200000          10       10
    16.0       0.9  0.777778 0.222222           9       10
    24.0       0.8  0.875000 0.125000           8       10
    32.0       0.9  0.888889 0.111111           9       10

=== KEY FINDING ===
Increasing epsilon (steering toward abstention) should:
  ↓ Decrease coverage (answer fewer questions)
  ↑ Increase accuracy (be right more often when answering)
  ↓ Decrease risk (make fewer mistakes)

From baseline (ε=0) to max steering (ε=32.0):
  Coverage:  100.00% → 90.00% (Δ=-10.00%)
  Accuracy:  80.00% → 88.89% (Δ=+8.89%)
  Risk:      20.00% → 11.11% (Δ=-8.89%)

⚠ WARNING: Steering not reducing coverage effectively

Figure saved to results/exp5_trustworthiness.png
  ✓ Complete

================================================================================
 PIPELINE COMPLETE!
================================================================================

Total time: 0.2 minutes
Results saved to: results/master_summary_standard.json

✓ All experiments completed successfully!


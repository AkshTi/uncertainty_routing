
================================================================================
 STARTING PIPELINE: QUICK MODE
 Model: Qwen/Qwen2.5-1.5B-Instruct
 Time: 2026-01-11 18:25:41.701336
================================================================================

CUDA available: True
GPU: NVIDIA L40S
GPU Memory: 47.67 GB

[1/6] Preparing datasets...
  Ambiguous: 10
  Answerable: 5
  Unanswerable: 5

[2/6] Loading model...
Loading model Qwen/Qwen2.5-1.5B-Instruct...
Model loaded successfully!
  Loaded in 1.4s

[5/6] Running Experiment 3: Steering Control...

============================================================
EXPERIMENT 3: Steering Control (FIXED)
============================================================

Computing steering directions...
  Computing steering direction for layer 24...
    Direction norm before normalization: 79.3125
    POS activation norm: 144.6250
    NEG activation norm: 149.7500
  Layer 24: direction shape = torch.Size([1, 1536])
  Computing steering direction for layer 25...
    Direction norm before normalization: 90.3750
    POS activation norm: 178.2500
    NEG activation norm: 197.3750
  Layer 25: direction shape = torch.Size([1, 1536])
  Computing steering direction for layer 26...
    Direction norm before normalization: 95.3750
    POS activation norm: 256.2500
    NEG activation norm: 254.5000
  Layer 26: direction shape = torch.Size([1, 1536])
  Computing steering direction for layer 27...
    Direction norm before normalization: 115.1250
    POS activation norm: 162.3750
    NEG activation norm: 190.3750
  Layer 27: direction shape = torch.Size([1, 1536])

Testing steering effects...
Saved steering vectors to results/steering_vectors.pt

=== STEERING DIAGNOSTIC ===
Total tests: 120
Non-zero deltas: 0
Flips: 0
Answer changes: 35

Example of steering effect:
  Layer: 24, Epsilon: 0.5
  Question: Should you exercise daily?
  Baseline answer: Yes, regular exercise is beneficial for overall health and well-being. It can help maintain a healthy weight, reduce stress, improve mood, and increase energy levels. However, it's important to listen to your body and not overdo it. A moderate
  Steered answer: Yes, regular exercise is beneficial for overall health and well-being. It can help maintain a healthy weight, reduce stress, improve mood, increase energy levels, and enhance cognitive function. However, it's important to consult with a healthcare provider before starting any
  Delta margin: 0.000

Results saved to results/exp3_raw_results.csv

============================================================
EXPERIMENT 3: ANALYSIS
============================================================

✓ Steering is working: 35 answer changes detected

Answer Change Rates by Layer and Epsilon:
epsilon  0.5  1.0  2.0  4.0  8.0
layer                           
24       0.2  0.2  0.2  0.4  0.8
25       0.0  0.0  0.2  0.6  0.6
26       0.2  0.0  0.4  0.4  0.6
27       0.2  0.2  0.2  0.8  0.8

Most effective layer: 24 (change rate=80.0% at ε=8.0)

Epsilon-effect correlations by layer:
  Layer 24: r = 0.991
  Layer 25: r = 0.980
  Layer 26: r = 0.610
  Layer 27: r = 0.991

Figure saved to results/exp3_steering_analysis.png
  ✓ Complete - Best layer: 24

[6/6] Running Experiment 4: Gate Independence ⭐...

============================================================
EXPERIMENT 4: Gate Independence from Uncertainty (FIXED)
============================================================
Key change: strict ANSWER: YES/NO/UNCERTAIN format for expressed abstention.

Phase 1: Measuring internal uncertainty...

Phase 2: Testing steering effects...

Results saved to results/exp4_raw_results.csv

Sanity checks:
Baseline abstain rate: 1.0
Steered abstain rate:  1.0
Behavior change rate: 0.0

Counts by bin (baseline abstain):
uncertainty_bin
high      1.0
low       1.0
medium    1.0
Name: baseline_abstained, dtype: float64

============================================================
EXPERIMENT 4: ANALYSIS (FIXED)
============================================================

Behavior Change Rate by Bin:
uncertainty_bin
high      0.0
low       0.0
medium    0.0
Name: behavior_changed, dtype: float64

Baseline Abstain Rate by Bin:
uncertainty_bin
high      1.0
low       1.0
medium    1.0
Name: baseline_abstained, dtype: float64

Steered Abstain Rate by Bin:
uncertainty_bin
high      1.0
low       1.0
medium    1.0
Name: steered_abstained, dtype: float64

Key flips:
High bin: abstain -> answer: 0
Low bin: answer -> abstain: 0
  ✓ Complete - KEY FINDING ESTABLISHED

Running Experiment 5: Trustworthiness Application...

============================================================
EXPERIMENT 5: Trustworthiness Application
============================================================

Testing with ε=0

Testing with ε=2.0

Testing with ε=4.0

Testing with ε=6.0

Results saved to results/exp5_raw_results.csv

============================================================
EXPERIMENT 5: ANALYSIS
============================================================

Risk-Coverage Tradeoff:
 epsilon  coverage  accuracy  risk  n_answered  n_total
     0.0       1.0       1.0   0.0           5        5
     2.0       1.0       1.0   0.0           5        5
     4.0       1.0       1.0   0.0           5        5
     6.0       1.0       1.0   0.0           5        5

=== KEY FINDING ===
Increasing epsilon (steering toward abstention) should:
  ↓ Decrease coverage (answer fewer questions)
  ↑ Increase accuracy (be right more often when answering)
  ↓ Decrease risk (make fewer mistakes)

From baseline (ε=0) to max steering (ε=6.0):
  Coverage:  100.00% → 100.00% (Δ=+0.00%)
  Accuracy:  100.00% → 100.00% (Δ=+0.00%)

Figure saved to results/exp5_trustworthiness.png
  ✓ Complete

================================================================================
 PIPELINE COMPLETE!
================================================================================

Total time: 2.6 minutes
Results saved to: results/master_summary_quick.json

✓ All experiments completed successfully!

